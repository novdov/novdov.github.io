> 출처: ゼロから作るDeep Learning 02 (斎藤 康毅 저, O’Reilly Japan, 2018)
>
> ゼロから作るDeep Learning 02 (밑바닥부터 시작하는 딥러닝 2) 원서의 7장, “RNNによる文章生成 (RNN을 이용한 문장 생성)”을 요약한 내용입니다.



## 1. Language Model (언어 모델)을 사용한 문장 생성

### 1.1 RNN을 이용한 문장 생성의 순서

먼저, “you say goodbye and I say hello.”라는 문장을 이용해 문장 생성의 순서를 밟아가본다. 이 문장에서 “I” 라는 단어를 기준으로 생각하면 언어 모델은 “I” 다음에 나타날 단어를 아래와 같은 확률 분포로 나타낸다.



<7-2 그림>



이를 이용해 새로운 단어를 생성하려면 어떻게 해야 할까? 위의 그림에서 볼 수 있듯이 I 다음에 say가 등장할 확률이 가장 높기 때문에, say가 선택된다. 물론, say 외의 단어들도 I 다음에 등장할 확률이 높다면 등장할 수 있다. 중요한 것은 이러한 과정이 **확률적**이라는 것이다.

단어 2개를 생성하는 과정도 마찬가지다. say 다음에 등장할 확률이 아래 그림에서 나타나는 것과 같다고 가정하면 그 다음에 등장할 확률이 높은 단어가 샘플링된다. 이 과정을 (\<eos> 등의) 문장의 끝을 나타내는 토큰이 나타날 때까지 반복하면 하나의 문장을 생성할 수 있다.

### 1.2 문장 생성 실습

위에서 서술한 문장 생성 과정을 코드로 나타내면 아래와 같다.



 